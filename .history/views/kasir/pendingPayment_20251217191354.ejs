<div class="container mt-4">
    <h2><i class="fas fa-file-invoice-dollar"></i> Daftar Tunggu Pembayaran</h2>
    <div class="card shadow-sm">
        <div class="card-body">
            <table class="table table-hover">
                <thead class="table-dark">
                    <tr>
                        <th>Plat Nomor</th>
                        <th>Pelanggan</th>
                        <th>Mekanik</th>
                        <th>Total Biaya</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody>
                    <% if (jobs.length > 0) { %>
                        <% jobs.forEach(job => { %>
                            <tr>
                                <td><strong><%= job.vehicle.licensePlate %></strong></td>
                                <td><%= job.customer.name %></td>
                                <td><%= job.assignedTo ? job.assignedTo.name : '-' %></td>
                                <td>Rp <%= new Intl.NumberFormat('id-ID').format(job.totalAmount) %></td>
                                <td>
                                    <button class="btn btn-primary btn-sm" onclick="printReceipt('<%= job._id %>')">
                                        <i class="fas fa-print"></i> Cetak Resi
                                    </button>
                                </td>
                            </tr>
                        <% }) %>
                    <% } else { %>
                        <tr><td colspan="5" class="text-center">Belum ada pekerjaan yang selesai.</td></tr>
                    <% } %>
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
function printReceipt(jobId) {
    const printWindow = window.open(`/api/jobs/print/${jobId}`, '_blank');
    printWindow.focus();
}
</script>